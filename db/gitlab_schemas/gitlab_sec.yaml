name: gitlab_sec
description: Schema for all Cell-local Security features.
allow_cross_joins:
  - gitlab_shared
  - gitlab_main:
      specific_tables:
      - vulnerability_state_transitions
  - gitlab_main_cell:
      specific_tables:
      - security_findings
      - security_scans
      - vulnerabilities
      - users_security_dashboard_projects
      - vulnerability_exports
      - vulnerability_external_issue_links
      - vulnerability_feedback
      - vulnerability_finding_evidences
      - vulnerability_finding_links
      - vulnerability_finding_signatures
      - vulnerability_findings_remediations
      - vulnerability_flags
      - vulnerability_historical_statistics
      - vulnerability_namespace_historical_statistics
      - vulnerability_identifiers
      - vulnerability_issue_links
      - vulnerability_merge_request_links
      - vulnerability_occurrence_identifiers
      - vulnerability_occurrences
      - vulnerability_reads
      - vulnerability_remediations
      - vulnerability_scanners
      - vulnerability_state_transitions
      - vulnerability_statistics
      - vulnerability_user_mentions
      - dependency_list_exports
      - sbom_component_versions
      - sbom_components
      - sbom_occurrences
      - sbom_occurrences_vulnerabilities
      - sbom_sources
      - dast_profile_schedules
      - dast_profiles
      - dast_profiles_pipelines
      - dast_profiles_tags
      - dast_scanner_profiles
      - dast_scanner_profiles_builds
      - dast_site_profile_secret_variables
      - dast_site_profiles
      - dast_site_profiles_builds
      - dast_site_tokens
      - dast_site_validations
      - dast_sites
allow_cross_transactions:
  - gitlab_internal
  - gitlab_shared
  - gitlab_main:
      specific_tables:
      - vulnerability_state_transitions
  - gitlab_main_cell:
      specific_tables:
      - security_findings
      - security_scans
      - vulnerabilities
      - users_security_dashboard_projects
      - vulnerability_exports
      - vulnerability_external_issue_links
      - vulnerability_feedback
      - vulnerability_finding_evidences
      - vulnerability_finding_links
      - vulnerability_finding_signatures
      - vulnerability_findings_remediations
      - vulnerability_flags
      - vulnerability_historical_statistics
      - vulnerability_namespace_historical_statistics
      - vulnerability_identifiers
      - vulnerability_issue_links
      - vulnerability_merge_request_links
      - vulnerability_occurrence_identifiers
      - vulnerability_occurrences
      - vulnerability_reads
      - vulnerability_remediations
      - vulnerability_scanners
      - vulnerability_state_transitions
      - vulnerability_statistics
      - vulnerability_user_mentions
      - dependency_list_exports
      - sbom_component_versions
      - sbom_components
      - sbom_occurrences
      - sbom_occurrences_vulnerabilities
      - sbom_sources
      - dast_profile_schedules
      - dast_profiles
      - dast_profiles_pipelines
      - dast_profiles_tags
      - dast_scanner_profiles
      - dast_scanner_profiles_builds
      - dast_site_profile_secret_variables
      - dast_site_profiles
      - dast_site_profiles_builds
      - dast_site_tokens
      - dast_site_validations
      - dast_sites
allow_cross_foreign_keys:
  - gitlab_main:
      specific_tables:
      - vulnerability_state_transitions
require_sharding_key: true
